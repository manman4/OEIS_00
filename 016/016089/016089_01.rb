require 'matrix'

def power(a, n, mod)
  return Matrix.I(a.row_size) if n == 0
  m = power(a, n >> 1, mod)
  m = (m * m).map{|i| i % mod}
  return m if n & 1 == 0
  (m * a).map{|i| i % mod}
end

def f(n)
  ary0 = [1, 2]
  v = Vector.elements(ary0)
  ary1 =
  [[1, 1],
   [1, 0]]
  a = Matrix[*ary1]
  mod = n
  (power(a, n, mod) * v)[1] % mod
end

# 間違った値も含む
@str =
'1 1
2 6
3 18
4 54
5 162
6 486
7 1458
8 1926
9 4374
10 5778
11 13122
12 17334
13 39366
14 52002
15 118098
16 156006
17 206082
18 354294
19 468018
20 618246
21 1062882
22 1404054
23 1854738
24 2471058
25 3188646
26 4212162
27 5564214
28 7413174
29 9565938
30 12636486
31 16692642
32 22050774
33 22239522
34 28697814
35 37909458
36 38259378
37 41218326
38 50077926
39 66152322
40 66718566
41 86093442
42 113728374
43 114778134
44 123654978
45 150233778
46 198456966
47 200155698
48 258280326
49 264403206
50 341185122
51 344334402
52 370964934
53 450701334
54 595370898
55 600467094
56 600917778
57 600929334
58 600935058
59 722113254
60 774840978
61 793209618
62 1023555366
63 1033003206
64 1112894802
65 1352104002
66 1786112694
67 1801401282
68 1802753334
69 1802788002
70 1802805174
71 2166339762
72 2324522934
73 2359432818
74 2379628854
75 3070666098
76 3099009618
77 3170367414
78 3338684406
79 4056312006
80 4093753446
81 4410360882
82 5358338082
83 5404203846
84 5408260002
85 5408364006
86 5408415522
87 6499019286
88 6973568802
89 7078298454
90 7138886562
91 9211998294
92 9363385350
93 9443706570
94 9544902705
95 9685512225
96 9762540491
97 9931923702
98 9933538923
99 9964518750'

ary = []
@str.split(/\n/).map{|i| i.split(' ')[1].to_i}.each{|i|
  # 正しいものだけ抽出
  ary << i if f(i) == 0
}
p ary
p ary.size
